(this["webpackJsonpmy-jumpto365"]=this["webpackJsonpmy-jumpto365"]||[]).push([[0],{119:function(e,t,n){},131:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},200:function(e,t,n){},270:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(286),r=n(52),o=n(61),i=n(88),c=n(71),s=n(69),l=n(0),u=n.n(l),p=n(26),d=n.n(p);function m(e,t){var n,l;return l=n=function(t){Object(c.a)(l,t);var n=Object(s.a)(l);function l(){var e;Object(r.a)(this,l);for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return(e=n.call.apply(n,[this].concat(a))).state={width:1200},e.mounted=!1,e.onWindowResize=function(){if(e.mounted){var t=d.a.findDOMNode(Object(i.a)(e));t instanceof HTMLElement&&e.setState({width:t.offsetWidth<1200?t.offsetWidth:1200})}},e}return Object(o.a)(l,[{key:"componentDidMount",value:function(){this.mounted=!0,window.addEventListener("resize",this.onWindowResize),this.onWindowResize()}},{key:"componentWillUnmount",value:function(){this.mounted=!1,window.removeEventListener("resize",this.onWindowResize)}},{key:"componentDidUpdate",value:function(e,t){this.props.fixedWidth&&this.props.fixedWidth!==e.fixedWidth&&this.setState({width:this.props.fixedWidth})}},{key:"render",value:function(){var t=this.props,n=t.measureBeforeMount,r=Object(a.a)(t,["measureBeforeMount"]);return n&&!this.mounted?u.a.createElement("div",{className:this.props.className,style:this.props.style}):u.a.createElement(e,Object.assign({},r,this.state))}}]),l}(u.a.Component),n.defaultProps={measureBeforeMount:!1},l}},279:function(e){e.exports=JSON.parse('{"name":"my-jumpto365","version":"0.1.1","private":true,"homepage":"https://my.jumpto365.com","dependencies":{"@microsoft/microsoft-graph-client":"^2.0.0","animejs":"^3.1.0","axios":"^0.19.0","dexie":"^2.0.4","dexie-observable":"^1.0.0-beta.5","dexie-syncable":"^1.0.0-beta.4","exceljs":"^3.5.0","https":"^1.0.0","into-stream":"5.1.1","lodash":"^4.17.15","mammoth":"^1.4.9","moment":"^2.25.3","format-json":"^1.0.3","quill-delta-to-html":"^0.11.0","react":"^16.12.0","react-dom":"^16.12.0","react-dropzone":"^10.2.1","react-grid-layout":"^0.17.1","react-resizable":"^1.10.1","react-scripts":"3.2.0","react-masonry-css":"^1.0.14","string-to-stream":"^3.0.1","xlsx":"^0.15.4","@fluentui/react":"^7.115.3","@uifabric/icons":"^7.3.44","@uifabric/fluent-theme":"^7.1.84","react-tag-autocomplete":"^5.13.1","@reach/router":"^1.3.3","flow-bin":"^0.125.1","@microsoft/teams-js":"^1.6.0"},"devDependencies":{"gh-pages":"^2.1.1"},"scripts":{"flow":"flow","yarn":"yarn","start":"PORT=3018 react-scripts start","start-windows":"set PORT=3018 && set HTTPS=true &&react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject","config-default":"cp src/config/default/index.html public/index.html && cp src/config/default.js src/config/index.js","config-default-windows":"copy src\\\\config\\\\default\\\\index.html public\\\\index.html && copy src\\\\config\\\\default.js src\\\\config\\\\index.js","deploy":"react-scripts build && echo itpro.jumpto365.com > build/CNAME && cp build/index.html build/404.html && gh-pages -b master -d build -r https://github.com/ztickybar/itpro","deploywindows":"react-scripts build && echo itpro.jumpto365.com > build\\\\CNAME && copy build\\\\index.html build\\\\404.html && gh-pages -b master -d build -r https://github.com/ztickybar/itpro"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},281:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAASAAAAEgARslrPgAABidJREFUeNrtnc1vHdUZh5/3nBlf29dJbOLgOOAoSkwwIBKgsVIRGqkSq1AhqNIVC6Ru2j+gfwe7dsMCWIBUsajKh6qibKCtKqSGCgioNB+kSTCRUUzs4I/Y95yXxb1JiO+YAGfiI5f38ca+I78+M898nDm/OWNRVcXIhsvdgB87JiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzxeoPFJia+oJLM7MgklRcVRlo9rFr5yjebyzXMUZmPpvh6uLV9GIKzcEmgyODXYu6BcTI8y+9xst//CtF4ZP+bgiRgwfu5/fP/Y7Nm5rrtvHqYHlxmTf+8CZnPziLS9x5YghMPjHJkd8eQdzNO3W3AIWFhSVmvpyrRcDclQU2YuamqizNLzE/O1+DgMjy4nLlsmKtXxIRJPEUJJJ8FsuIAFLPdmDtDbGxTsz/h5iAzJiAzJiAzJiAzJiAzBTpJb47c3PLzC+0SO2ZKtDocQwONnBuw/ZzgXUWMPX5AufPf4VLPO5UYWiwwf79PSbg+9B+DFVRTR9j2oA315XYNSAzJiAzJiAzJiAzJiAzJmA9+JZOX2U3VIGomtTdEyBG5ZszoIR2H76ejOB2d0QVrm2DxERJY7tWu823SMScE57+xWHuHd+ZfJOjqoyObKWvtweAkZF+ms0yWYAqNHr9bb0JKxslP/vVIfb9/MHkQEajsn3P9so9Tyon6YUIMdazJiLQiTZbUdtHRQ1lnUDZiQqXWy2iai1DHIVzFP5ae6GmrYATKCoaWBHKK+dePcb0O/9GUscMYmTT3p2M/+aXuN4Gbxw/zz8/mU7ec6Mqu0c28ezhcZDAi387xpnpi7jEPTWo8ug99/HUIz9laUV4/u0VTl7U5KGTEJXD93qOThasXvXua4Aqsx+dYerNf+ASQ/kYIsMzc+z+9ZNIbw//+WyWYx9OUSSG3K0YOTA/zDOP7QECx8+e4l+fnqRwnh96fEmn7h3NAfSRg6xE4d0zkXdPR1KfqGkF2DrgODrZvaxbgIA4hys8kijAiSDeX7/uOCd47/DJ525301HknaNwHp+4qyqCc45OjI53UDiSBQB4oeoavHY3tL4+hq76fgMNo61DU+0+IDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDNrCqgv7JNV32+gZznXoakVgUx7qmpsheTDI4aIhnB9WDdGJYSIJFZuxUiMN8aKQ4y0Yug0/4cHMiFGYoydKkKI7VgydVS6FSBUZAFQGcgIWx7YzY4nDtUWSbqyQBAm7trC4w/uqC2SLJyAeH6ya5yh/oFaIsmJHWMIQung4G7HHf1SSyT5wF3VbasO5VutdjBfB06gLK83JNQ0aVhEKDsiW6EdytdxyvDi8K6dBK4EiDWUVW6ka6upfFXBicvKp7OB1OQwKgz3OSa3K4UIJ/97kfMXZtIf81AYGurnof1jIMJ7py8zc+VqDXWVndua3Dc2SIgtPj73AZfnv+wElGl1d2y9m/HRvV1trJwp//aFJV4/vYhPWSFpH0T7tpXs29aD98pf3jrBn/78XvJ7I0JQHn5ojImJUfCeF46d4vipS8lZc4iRo4d2MTG2hasrS7z691c4cfZ9nEt8Y0AMHDnwJHtG7+mSWflknFz7SjwCRG7u90RVQlRE0k5D8dpFWG/UjaokliVEbnoKrl03QuKEkqixfYqsoHJX3ECxeb1Idx/qdm8LuxFbhdzi57oxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAatY79HQNV/YpJ1gOmlldNVK3K4pYnXV1Ft+kFC4ulalgF4vbG649sy+BKJCf3kjAypLR29vgffp76TuKQtE2qvVUzoapU9OxAovncnf7Rip9D00ygZeUhOxgsKXlcsqQ/kvFiKzy/WE8n2FMNr0CPC/c5eYnp6r5VUFmzb3snd8BET45MIsc4sryWP3UWH7UB+7RgaIMXDm4im+WryCiCS9M0NVGd5yJ3cPj3VFkmL/TzgvdhHOjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIzNezxiKEIKwxBgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0wOS0xMFQwNTo0MDowNiswMDowMFT52voAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMDktMTBUMDU6NDA6MDYrMDA6MDAlpGJGAAAARnRFWHRzb2Z0d2FyZQBJbWFnZU1hZ2ljayA2LjcuOC05IDIwMTQtMDUtMTIgUTE2IGh0dHA6Ly93d3cuaW1hZ2VtYWdpY2sub3Jn3IbtAAAAABh0RVh0VGh1bWI6OkRvY3VtZW50OjpQYWdlcwAxp/+7LwAAABh0RVh0VGh1bWI6OkltYWdlOjpoZWlnaHQAMTkyDwByhQAAABd0RVh0VGh1bWI6OkltYWdlOjpXaWR0aAAxOTLTrCEIAAAAGXRFWHRUaHVtYjo6TWltZXR5cGUAaW1hZ2UvcG5nP7JWTgAAABd0RVh0VGh1bWI6Ok1UaW1lADE1MzY1NTgwMDZiJ+JmAAAAD3RFWHRUaHVtYjo6U2l6ZQAwQkKUoj7sAAAAVnRFWHRUaHVtYjo6VVJJAGZpbGU6Ly8vbW50bG9nL2Zhdmljb25zLzIwMTgtMDktMTAvZWI1MTNmMmE5ZWRkMzA1ZjhkZWEyODgzYTllYTNhNzguaWNvLnBuZ3XQqTUAAAAASUVORK5CYII="},296:function(e,t,n){e.exports=n(546)},302:function(e,t,n){},330:function(e,t,n){},331:function(e,t,n){},332:function(e,t,n){},348:function(e,t){},350:function(e,t){},382:function(e,t){},383:function(e,t){},448:function(e,t){},544:function(e,t,n){},546:function(e,t,n){"use strict";n.r(t);var a=n(5),r=n.n(a),o=n(9),i=n(3),c=n(52),s=n(61),l=n(71),u=n(69),p=n(0),d=n.n(p),m=n(26),f=n.n(m),h=(n(302),n(16)),g=n(599),b=n(605),v=n(612),x=n(140),y=n(31),O=n.n(y),w=n(8),j=n.n(w),E=(n(198),n(199),n(148),n(119),function(e){return e&&e.references?d.a.createElement("div",{className:"tags",style:{display:"flex",flexWrap:"wrap"}},e.references.map((function(e,t){return d.a.createElement("div",{key:t,style:{padding:"4px",margin:"4px",backgroundColor:e.color,color:e.textColor}},e.title)}))):null}),k=function(e){if(!e.text)return null;if(!e.filter)return e.text;var t=e.text.toLowerCase().indexOf(e.filter.toLowerCase());if(-1===t)return e.text;var n=e.text.substr(0,t),a=e.text.substr(t,e.filter.length),r=e.text.substr(t+e.filter.length);return d.a.createElement(d.a.Fragment,null,d.a.createElement("span",null,n),d.a.createElement("span",{style:e.style},a),d.a.createElement("span",null,r))},S=(n(200),function(e){var t=e.tile?e.tile:{},n=Object(p.useState)(""),a=Object(i.a)(n,2);a[0],a[1];return d.a.createElement(d.a.Fragment,null,1===e.tileSize&&d.a.createElement("div",{className:"supertile",style:{border:"0px dashed grey",margin:10,maxWidth:"300px"}},d.a.createElement("div",{style:{margin:10,padding:10,backgroundColor:t.color,color:t.textcolor,width:300,height:70,maxHeight:70,borderRadius:35,overflow:"hide"}},d.a.createElement("div",{style:{cursor:"pointer"},onClick:function(){e.onClick&&e.onClick(t)}},d.a.createElement("div",{style:{display:"flex"}},d.a.createElement("div",{style:{margin:8,marginTop:8,height:40}},d.a.createElement("img",{style:{height:"auto",width:40},src:t.icon})),d.a.createElement("div",{title:t.title,style:{flexGrow:1,height:"40px",width:"300px",overflow:"hidden",lineHeight:"40px",marginTop:"6px",marginLeft:"4px",fontSize:"24px"}},d.a.createElement(k,{text:t.title,filter:e.filter,style:e.highlightStyle})),d.a.createElement("div",{style:{alignItems:"flex-end"}},d.a.createElement("i",{style:{cursor:"pointer",display:"none"},class:e.isPinned?"ms-Icon ms-Icon--PinnedFill":"ms-Icon ms-Icon--Pinned",onClick:function(t){e.onPinnedClicked&&(t.preventDefault(),t.stopPropagation(),e.onPinnedClicked(e))},"aria-hidden":"true"}))," ")))),0===e.tileSize&&d.a.createElement("div",{style:{border:"0px dashed grey",margin:10,maxWidth:"300px"}},d.a.createElement("div",{style:{margin:10,padding:10,backgroundColor:t.color,color:t.textcolor,width:300,height:300,maxHeight:300,overflow:"auto"}},d.a.createElement("div",{style:{cursor:"pointer"},onClick:function(){e.onClick&&e.onClick(t)}},d.a.createElement("div",{style:{display:"flex"}},d.a.createElement("div",{style:{flexGrow:1}},d.a.createElement(k,{text:t.title,filter:e.filter,style:e.highlightStyle})," "),d.a.createElement("div",{style:{alignItems:"flex-end"}},d.a.createElement("i",{style:{cursor:"pointer",display:"none"},class:e.isPinned?"ms-Icon ms-Icon--PinnedFill":"ms-Icon ms-Icon--Pinned",onClick:function(t){e.onPinnedClicked&&(t.preventDefault(),t.stopPropagation(),e.onPinnedClicked(e))},"aria-hidden":"true"}))),d.a.createElement("div",{style:{textAlign:"center",margin:20,marginTop:40,height:120}},d.a.createElement("img",{style:{height:"auto",width:112},src:t.icon})),d.a.createElement("div",{style:{maxHeight:60,height:60,overflow:"auto"}},t.inShort),d.a.createElement(E,{references:t.references}))),d.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.externalArticle&&d.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,rel:"noopener noreferrer",target:"_blank"},"More info"))))}),A=n(72),C=function(e){return e&&e.errors?d.a.createElement("div",{className:"tags"},e.errors.map((function(e,t){return d.a.createElement("div",{key:t,style:{padding:"4px",margin:"4px"}},"When trying ",e.context,", you got",JSON.stringify(e))}))):null},I=(n(46),n(271)),L=n.n(I),T=n(78),P=n.n(T),D=(n(331),n(332),n(598)),N=n(4),z=n(604),R=n(616),M=(D.a,Object(N.D)()),W=(Object(N.H)({container:{display:"flex",flexFlow:"column nowrap",alignItems:"stretch"},header:[M.fonts.xLargePlus,{flex:"1 1 auto",borderTop:"4px solid ".concat(M.palette.themePrimary),color:M.palette.neutralPrimary,display:"flex",alignItems:"center",fontWeight:N.d.semibold,padding:"12px 12px 14px 24px"}],body:{flex:"4 4 auto",padding:"0 24px 24px 24px",overflowY:"hidden",selectors:{p:{margin:"14px 0"},"p:first-child":{marginTop:0},"p:last-child":{marginBottom:0}}}}),M.palette.neutralPrimary,M.palette.neutralDark,{LANDING:"landing",ONBOARDING:"onboarding",SEARCHING:"user-searched-for",SEARCHCLICKED:"user-clicked-search",TILECLICKED:"user-clicked-tile",TABCLICKED:"user-clicked-tab",DETAILSTOGGLED:"user-toggle-details",MEMBERSHIPSREAD:"memberships-read"});function B(e){if(window.amplitude&&e){var t=window.amplitude.getInstance();if(t){t.setUserId(e);var n=e.split("@");2===n.length&&t.setDomain(n[1])}}}function G(e,t){if(window.amplitude){var n=window.amplitude.getInstance();n&&(n.logEvent(e,t),console.log("trace",e,t))}}Object.freeze(W);n(333);var U=n(183),H=n.n(U),J={};J.analyseMembers=function(e,t,n){var a=[];t.split("\n").forEach((function(e){e.split(";").forEach((function(e){e.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi).forEach((function(e){a.push({checked:!1,smtp:e})}))}))}));var r=[],o=a.length;a.forEach((function(t){J.readUser(e,t.smtp,0,(function(e,a){o--,t.user=a,t.err=e,r.push(t),o<1&&(n(null,r),t.checked=!0)}))}))},J.invite=function(e,t,n,a){oe(e,"https://graph.microsoft.com/v1.0/invitations",{invitedUserEmailAddress:t,inviteRedirectUrl:n,invitedUserDisplayName:t,sendInvitationMessage:!1,invitedUserMessageInfo:{customizedMessageBody:"We are really happy to invite you to the JUMPTO365 #Insider program ",ccRecipients:[{emailAddress:{name:"Niels",address:"niels@jumpto365.com"}}]}},(function(e,t){if(e)return a(e);a(null,t)}))},J.addcrm=function(e,t,n,a,r,o){var i={properties:[{property:"firstname",value:n},{property:"lastname",value:a},{property:"internal_categories",value:r}]};Z(e,"https://api.hubapi.com/contacts/v1/contact/createOrUpdate/email/".concat(t,"/?hapikey=f305d92f-b379-4063-95fb-57e9d56976f2"),i,(function(e,t){if(e)return o(e);o(null,t)}))},J.addmember=function(e,t,n,a){var r={"@odata.id":"https://graph.microsoft.com/beta/directoryObjects/".concat(t)};oe(e,"https://graph.microsoft.com/beta/groups/".concat(n,"/members/$ref"),r,(function(e,t){if(e)return a(e);a(null)}))},J.getSharePointList=function(e,t,n,a,r,o,i){ie(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":").concat(n,":/lists/").concat(a,"/items?").concat(r),(function(r,c){if(r)return i(r);var s=[];!function r(){if(0===c.length)return i(null,s);var l=c.pop();ie(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":").concat(n,":/lists/").concat(a,"/items/").concat(l.id,"?").concat(o),(function(e,t){if(e)return i(e);s.push(t),r()}))}()}))},J.getPages=function(e,t,n,a){ie(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":").concat(n),(function(t,n){if(t)return a(t);ie(e,"https://graph.microsoft.com/beta/sites/".concat(n.id,"/pages"),(function(e,t){return e?a(e):a(null,t)}))}))},J.readGroupMembers=function(e,t,n){ie(e,"https://graph.microsoft.com/beta/groups/"+t+"/members?$select=mail,department,displayName,country,accountEnabled,userPrincipalName,givenName,surname,id",n)},J.readGroupMemberShipFor=function(e,t,n){ie(e,"https://graph.microsoft.com/v1.0/users/"+t+"/memberOf",n)},J.readManager=function(e,t,n,a){ie(e,"https://graph.microsoft.com/v1.0/users/"+t+"/manager",a,null,n)},J.readUser=function(e,t,n,a){ie(e,"https://graph.microsoft.com/v1.0/users/"+t,a,null,n)},J.readUser=function(e,t,n,a){ie(e,"https://graph.microsoft.com/v1.0/users/"+t,a,null,n)},J.matchingGroups=function(e,t,n){ie(e,"https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=startsWith(displayName,'".concat(t,"')"),n)},J.findGroup=function(e,t,n){ie(e,"https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=mailNickname eq '".concat(t,"'"),n)},J.getGroupDocuments=function(e,t,n,a){ie(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive/items/root:").concat(n,":/children"),a)},J.getGroupDrive=function(e,t,n){ie(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive"),n)},J.getGroupSite=function(e,t,n){ie(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/sites/root"),n)},J.getDriveChildren=function(e,t,n,a){ie(e,"https://graph.microsoft.com/beta/drives/".concat(t,"/items/").concat(n,"/children"),a)},J.getGroupRootFolders=function(e,t,n){ie(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive/items/root/children"),n)},J.getSharePointSiteByName=function(e,t,n,a){ie(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":/sites/").concat(n),a)},J.getSharePointSiteDrive=function(e,t,n,a){ie(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,"/drive/root:/").concat(n,":/children"),a)},J.getSharePointSiteByName=function(e,t,n,a){ie(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":/sites/").concat(n),a)},J.copyfile=function(e,t,n,a,r,o,i){J.findGroup(e,t,(function(t,c){if(t)return i(t);if(1!==c.length)return i("Did't find a unique group");var s=c[0];J.getGroupDocuments(e,s.id,"/"+n,(function(t,n){if(t)return i(t);var c=j.a.find(n,{name:a});J.getGroupRootFolders(e,s.id,(function(t,n){if(t)return i(t);var a=j.a.find(n,{name:r});if(!a)return i("Did't find target folder");J.newDoc(e,s.id,c.id,a.parentReference.driveId,a.id,o,(function(e,t){return e?i(e):i(null,t)}))}))}))}))},J.newDoc=function(e,t,n,a,r,o,i){oe(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive/items/").concat(n,"/copy"),{parentReference:{driveId:a,id:r},name:o},(function(t){if(t)return i(t);!function e(t,n,a,r,o,i){J.getDriveChildren(t,n,a,(function(c,s){if(c)return i(c);for(var l=0;l<s.length;l++){var u=s[l];if(console.log("Comparing",u.name,r),u.name===r)return console.log("Match found"),i(null,u)}var p=0;setTimeout((function(){if(console.log("Retrying",o),p>10)return i("Think that the file has been created, but could not find a reference to if. Filename is ".concat(r," - Tryed ").concat(o," to find it "));e(t,n,a,r,o+1,i)}),1e3)}))}(e,a,r,o,0,i)}))};var F=function e(){var t=this;Object(c.a)(this,e),this.get=function(e,n){return new Promise((function(a,r){ie(t.token,e,(function(e,t){return e?r(e):a(t)}),null,null,null,n)}))},this.post=function(e,n){return new Promise((function(a,r){oe(t.token,e,n,(function(e,t){return e?r(e):a(t)}))}))},this.patch=function(e,n){return new Promise((function(a,r){!function(e,t,n,a){O.a.patch(t,n,{headers:{"content-type":"application/json",authorization:"Bearer "+e}}).then((function(e){a(null,e.data)})).catch((function(e){a(e)}))}(t.token,e,n,(function(e,t){return e?r(e):a(t)}))}))},this.put=function(e,n){return new Promise((function(a,r){!function(e,t,n,a){O.a.put(t,n,{headers:{"content-type":"application/json",authorization:"Bearer "+e}}).then((function(e){a(null,e.data)})).catch((function(e){a(e)}))}(t.token,e,n,(function(e,t){return e?r(e):a(t)}))}))},this.getRaw=function(e){return function(e,t){return console.log("getting",t),new Promise((function(n,a){H.a.get({url:t,headers:{authorization:"Bearer "+e}},(function(e,t,r){if(e)return a(e);n({body:r,response:t})}))}))}(t.token,e)},this.getImage=function(e){return function(e,t){return new Promise((function(n,a){try{var r=new XMLHttpRequest;r.onload=function(){var e=new FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(r.response)},r.open("GET",t),r.setRequestHeader("Authorization","Bearer "+e),r.responseType="blob",r.send()}catch(o){a(o)}}))}(t.token,e)},this.token=$.getAccessToken()};var Y=function(e,t){return(new F).get(e,t)},Z=function(e,t){return(new F).post(e,t)},V=function(e,t){return(new F).put(e,t)},_=function(e){return Y("https://graph.microsoft.com/v1.0/me/drive/root:/".concat(e))},K=function(e){return Y("https://graph.microsoft.com/v1.0/me/drive/root:/".concat(e,":/children"))},q=function(e,t){return new Promise(function(){var n=Object(o.a)(r.a.mark((function n(a,o){var i;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,_(e).catch((function(e){o(e)}));case 2:if(i=n.sent){n.next=5;break}return n.abrupt("return");case 5:Y("https://graph.microsoft.com/v1.0/me/drive/items/".concat(i.id,":/").concat(t)).then((function(e){O.a.get(e["@microsoft.graph.downloadUrl"]).then((function(e){a(e.data)})).catch((function(e){o(e)}))})).catch((function(e){o(e)}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},Q=function(e,t,n){return new Promise(function(){var a=Object(o.a)(r.a.mark((function a(o,i){var c;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("Size of payload",n.length),a.next=3,_(e).catch((function(e){i(e)}));case 3:if(c=a.sent){a.next=6;break}return a.abrupt("return");case 6:V("https://graph.microsoft.com/v1.0/me/drive/items/".concat(c.id,":/").concat(t,":/content"),n).then((function(e){o(e)})).catch((function(e){i(e)}));case 7:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())},X=function(e){var t=new F;return new Promise(function(){var n=Object(o.a)(r.a.mark((function n(a,i){var c,s,l,u,p;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.get("https://graph.microsoft.com/v1.0/me/memberOf").catch((function(e){return i(e)}));case 3:if(c=n.sent,s=0,l=[],c){n.next=8;break}return n.abrupt("return",i("Not able to read membership"));case 8:u=c.length,p=0,e&&e(0),c.map(function(){var n=Object(o.a)(r.a.mark((function n(o){var i;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s++,n.next=3,ee(o,t);case 3:if(i=n.sent,p++,e&&e(p/u),l.push(i),0!==--s){n.next=10;break}return n.abrupt("return",a(l.sort((function(e,t){return e.text<t.text?-1:e.text>t.text?1:0}))));case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(0),i(n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})));return function(e,t){return n.apply(this,arguments)}}(),null)},$={};function ee(e,t){return new Promise(function(){var n=Object(o.a)(r.a.mark((function n(a,o){var i,c,s,l,u;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=Object(h.a)(Object(h.a)({},e),{},{key:e.id,text:e.title?e.title:e.displayName,title:e.description}),n.next=3,t.getImage("https://graph.microsoft.com/v1.0/groups/".concat(e.id,"/photo/$value")).catch((function(e){console.log("Photo read error")}));case 3:return(c=n.sent)&&c.indexOf("data:application/json")>-1&&(c=null),n.next=7,t.get("https://graph.microsoft.com/v1.0/teams/".concat(e.id)).catch((function(e){return console.log("Team details read error")}));case 7:return s=n.sent,(e.creationOptions?e.creationOptions:[]).forEach((function(e){"YammerProvisioning"===e&&(i.hasYammer=!0),"ProvisionGroupHomepage"===e&&(i.hasSharePoint=!0)})),(e.resourceProvisioningOptions?e.resourceProvisioningOptions:[]).forEach((function(e){"YammerProvisioning"===e&&(i.hasYammer=!0),"ProvisionGroupHomepage"===e&&(i.hasSharePoint=!0)})),n.next=12,te(t,e).catch((function(e){}));case 12:return l=n.sent,n.next=15,ae(t,e).catch((function(e){}));case 15:u=n.sent,i.hasTeams=void 0!==l,i.data={endPoints:u,details:s,photo:c,channels:l},a(i);case 19:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=Object(o.a)(r.a.mark((function e(t,n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=0,e.abrupt("return",new Promise(function(){var e=Object(o.a)(r.a.mark((function e(i,c){var s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("https://graph.microsoft.com/beta/teams/".concat(n.id,"/channels")).catch((function(e){console.log("Channel read error")}));case 2:if(s=e.sent){e.next=5;break}return e.abrupt("return",i());case 5:s.forEach(function(){var e=Object(o.a)(r.a.mark((function e(o){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a++,e.next=3,t.get("https://graph.microsoft.com/beta/teams/".concat(n.id,"/channels/").concat(o.id,"/tabs")).catch((function(e){console.log("Channel read tabs",e)}));case 3:c=e.sent,o.tabs=c,0===--a&&i(s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e,t){return re.apply(this,arguments)}function re(){return(re=Object(o.a)(r.a.mark((function e(t,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.get("https://graph.microsoft.com/beta/groups/".concat(n.id,"/endpoints")));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e,t,n,a){O.a.post(t,n,{headers:{"content-type":"application/json",authorization:"Bearer "+e}}).then((function(e){a(null,e.data)})).catch((function(e){a(e)}))}function ie(e,t,n,a,r,o,i){console.log("getting",t,!0===a),H.a.get({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e}},(function(c,s,l){var u;if(c){var p=o?o+1:1;return p>3?n(c,null,r):(console.log("retry #",p),ie(e,t,n,a,r,p))}if((u=JSON.parse(l)).error)return n(u.error,null,r);if(u["@odata.nextLink"]){var d,m=!i||!i.skipNextLink;if(d=a?a.concat(u.value):u.value,m)return ie(e,u["@odata.nextLink"],n,d,r)}a?n(null,a.concat(u.value),r):u.value?n(null,u.value,r):n(null,u,r)}))}$.getAccessToken=function(){return sessionStorage.getItem("access_token")};n(279);var ce="Apps/jumpto365.com",se="Apps/jumpto365.com/boards",le="index-contexts.json";function ue(e){return new Promise((function(t,n){var a=[],r=0;e.forEach((function(e){a.push(e.id),r++,Q(ce,pe(e.id),e).then((function(){--r<1&&Q(ce,"memberships.json",a).then((function(){t(a)})).catch((function(e){n(e)}))}))}))}))}function pe(e){return"membership."+e+".json"}function de(){return new Promise(function(){var e=Object(o.a)(r.a.mark((function e(t,n){var a,o,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(ce,"memberships.json").catch((function(e){n(e)}));case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return");case 5:o=0,i=[],a.forEach((function(e){o++,q(ce,pe(e)).then((function(e){i.push(e),--o<1&&t(i)})).catch((function(e){n(e)}))}));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}var me={layouts:{pending:!1}};function fe(){setTimeout((function(){if(console.log("delaywriteLayouts"),me.layouts.pending)return me.layouts.writing?fe():void he(me.layouts.folder,me.layouts.file,me.layouts.data)}),2e3)}function he(e,t,n){return new Promise(function(){var a=Object(o.a)(r.a.mark((function a(i,c){return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(console.log("writeLayouts"),!(me&&me.layouts&&me.layouts.writing)){a.next=11;break}if(!j.a.isEqual(me.layouts.data,n)){a.next=5;break}return console.log("writeLayouts no changes"),a.abrupt("return",i());case 5:return me.layouts.pending=!0,me.layouts.data=n,me.layouts.file=t,me.layouts.folder=e,fe(),a.abrupt("return",i());case 11:return a.prev=11,me.layouts.writing=!0,me.layouts.current=n,a.next=16,Q(e,t,n);case 16:new Promise(function(){var e=Object(o.a)(r.a.mark((function e(t,n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},e.next=3,ve();case 3:return e.sent.forEach((function(e){try{var t=e.file.name.split("."),n=t?t[0]:e.file.name;e.content.myTeams.forEach((function(e){var t=xe(e);a[t]?a[t].push({name:n,color:"#000000",backgroundColor:"#b3e6a9"}):a[t]=[{name:n,color:"#000000",backgroundColor:"#b3e6a9"}]}))}catch(r){console.log("indexLaunzhContexts",r)}})),e.next=7,Q(ce,le,a);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),i(),a.next=24;break;case 20:return a.prev=20,a.t0=a.catch(11),console.log("writeLayouts > error",a.t0),a.abrupt("return",c(a.t0));case 24:return a.prev=24,me.layouts.writing=!1,a.finish(24);case 27:case"end":return a.stop()}}),a,null,[[11,20,24,27]])})));return function(e,t){return a.apply(this,arguments)}}())}function ge(e,t){return q(e,t)}function be(){return K(se)}function ve(){return new Promise(function(){var e=Object(o.a)(r.a.mark((function e(t,n){var a,o,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(se).catch((function(e){n(e)}));case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return");case 5:o=0,i=[],a.forEach((function(e){o++,O.a.get(e["@microsoft.graph.downloadUrl"]).then((function(n){o--,i.push({file:e,content:n.data}),o<1&&t(i)})).catch((function(e){n(e)}))}));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function xe(e){var t=e&&e.data&&e.data.details?e.data.details.webUrl:"";if(e.data)var n=j.a.groupBy(e.data.endPoints?e.data.endPoints:[],(function(e){return e.providerName}));return e&&e.tile?e.tile.jumpto?e.tile.jumpto:e.tile.externalArticle:n.Yammer?n.Yammer[0].uri:function(e){if(e){var t=e.split("https://teams.microsoft.com/l/team/")[1].split("/conversations?"),n=e.split("groupId=")[1].split("&"),a=e.split("tenantId="),r=t[0],o=n[0],i=a[1],c="https://teams.microsoft.com/_?tenantId=".concat(i,"#/conversations/unknown?groupId=").concat(o,"&threadId=").concat(r,"&ctx=channel");"https://teams.microsoft.com/_?tenantId=".concat(i,"#/files/unknown?groupId=").concat(o,"&threadId=").concat(r,"&ctx=channel");return c}return null}(t)}function ye(){return q(ce,le)}var Oe=n(53),we=(n(285),{default:11,3600:11,3300:10,3e3:9,2700:8,2400:7,2100:6,1800:5,1500:4,1200:3,900:2,600:1}),je=function(e){var t=Object(p.useState)(e.details),n=Object(i.a)(t,2),a=(n[0],n[1],Object(p.useState)(!1)),r=Object(i.a)(a,2),o=r[0];r[1];if(e&&e.memberShips){var c=j.a.cloneDeep(e.memberShips);return e.tiles&&(e.tiles.forEach((function(e){c.push({displayName:e.title,tile:e})})),c=j.a.sortBy(c,["displayName"])),d.a.createElement("div",{className:"tags",style:{padding:"4px",margin:"4px",fontSize:"16px",display:"flex",flexWrap:"wrap",minWidth:"300px"}},d.a.createElement(L.a,{breakpointCols:we,className:"my-masonry-grid",columnClassName:"my-masonry-grid_column"},c.map((function(t,n){return d.a.createElement(Ee,Object.assign({},e,{key:n,team:t,viewChannels:e.details,viewDates:o,onSaveTeam:e.onSaveTeam}))}))))}return null};function Ee(e){var t=e.team?e.team:{},n=t.data?t.data.photo:null;return d.a.createElement("div",null,n&&d.a.createElement("div",null,d.a.createElement("div",{className:"pinnedTile2",style:{color:"#ffffff",backgroundColor:"#3f418e",minWidth:"48px"}},d.a.createElement("img",{src:"https://blob.jumpto365.com/images/h/e/x/hexatown.com/m/matt@hexatown.com/2019/09/Microsoft_Teams_256x256.png-20190920-092147.png",style:{margin:"12px",height:"24px",width:"24px"}}),t.text)),t.tile&&t.tile.icon&&d.a.createElement("div",{className:"pinnedTile2",style:{color:"#ffffff",backgroundColor:t.tile.color,minWidth:"48px"}},d.a.createElement("img",{src:t.tile.icon,style:{margin:"12px",height:"24px",width:"24px"}}),t.tile.title))}var ke=n(281),Se={clientId:"0387fbb2-eb27-4739-ba8a-814349f1a5c0",directoryId:"df96b8c9-51a1-40cf-b8b1-4514be8e9668",scopes:"https://graph.microsoft.com/TeamsActivity.Read  https://graph.microsoft.com/TeamsActivity.Send https://graph.microsoft.com/User.Read ",title:"My Jumpto365",logo:n.n(ke).a,defaultTableAPI:"https://api.jumpto365.com/table/hexatown.com/PTO365",niels:"niels@jumpto365.com",teamsIntegration:!0,options:[],components:{header:d.a.createElement("div",{style:{marginTop:"49px"}},d.a.createElement("div",{style:{borderBottom:"1px solid #cccccc",position:"fixed",backgroundColor:"#ffffff",width:"100vw",left:0,top:0,zIndex:1}},d.a.createElement("div",{style:{display:"flex",padding:"10px"}},d.a.createElement("div",{style:{flexGrow:1,display:"flex"}},d.a.createElement("div",null,d.a.createElement("a",{style:{color:"inherit",textDecoration:"none"},href:"/",target:"_blank"}," ",d.a.createElement("div",{className:"ms-font-xxl",style:{marginLeft:"16px",lineHeight:"36px",padding:"0px",color:"333"}},"IT Pros")))),d.a.createElement("div",null),d.a.createElement("div",{style:{flexGrow:1}},d.a.createElement("div",{style:{minWidth:"150px"}},"\xa0")))))}};n(131),n(132),n(133);function Ae(e){if(!e)return{};var t={},n=e.split("?");if(n.length>1)for(var a=n[1].split("&"),r=0;r<a.length;r++){var o=a[r].split("=");t[o[0]]=decodeURIComponent(o[1])}return t}function Ce(){try{return window.self!==window.top}catch(e){return!0}}var Ie=n(613),Le=n(597),Te=n(607),Pe=n(600),De=n(13);n(544);function Ne(e){var t=e&&e.breakpoints?j.a.keys(e.breakpoints):[];return d.a.createElement("div",{className:"breakpoints",style:{display:"flex"}},t.map((function(t,n){return d.a.createElement("div",{key:n,className:"breakpoint ".concat(t===e.selected?"selected":""),onClick:function(){e.onSelect&&e.onSelect(t)}},t)})))}var ze=n(614),Re=n(12),Me=n(617),We=n(79),Be=n(601),Ge=n(284),Ue=n(594),He=n(141),Je=n(592),Fe=(D.a,Object(N.I)(N.E),{type:We.a.normal,title:"Name your board",closeButtonAriaLabel:"Close",subText:"Give your board a descriptive name, use 30-40 characters if you like"});function Ye(e){var t=Object(p.useState)(!1),n=Object(i.a)(t,2),a=n[0],r=n[1],o=Object(p.useState)(""),c=Object(i.a)(o,2),s=c[0],l=c[1];Object(Je.a)("dialogLabel"),Object(Je.a)("subTextLabel");return d.a.createElement(d.a.Fragment,null,d.a.createElement(Be.a,{hidden:a,onDismiss:function(){r(!0)},dialogContentProps:Fe},d.a.createElement(b.a,{autoFocus:!1,label:"Name",text:s,onChange:function(e,t){l(t)},placeholder:"",xiconProps:{iconName:"Filter"}}),d.a.createElement(Ge.a,null,d.a.createElement(Ue.a,{text:"Save",disabled:""===s,onClick:function(){r(!0),e.onAdd&&e.onAdd(s)}}),d.a.createElement(He.a,{text:"Cancel",onClick:function(){r(!0),e.onDismiss&&e.onDismiss()}}))))}var Ze,Ve,_e={moveMenuItemText:"Move",closeMenuItemText:"Close",menu:D.a},Ke={iconName:"Cancel"},qe=Object(N.D)(),Qe=Object(N.H)({container:{display:"flex",flexFlow:"column nowrap",alignItems:"stretch"},header:[qe.fonts.xLargePlus,{flex:"1 1 auto",borderTop:"4px solid ".concat(qe.palette.themePrimary),color:qe.palette.neutralPrimary,display:"flex",alignItems:"center",fontWeight:N.d.semibold,padding:"12px 12px 14px 24px"}],body:{flex:"4 4 auto",padding:"0 24px 24px 24px",minWidth:"95vw",minHeight:"90vh",overflowY:"hidden",selectors:{p:{margin:"14px 0"},"p:first-child":{marginTop:0},"p:last-child":{marginBottom:0}}}}),Xe={root:{color:qe.palette.neutralPrimary,marginLeft:"auto",marginTop:"4px",marginRight:"2px"},rootHovered:{color:qe.palette.neutralDark}};Object(x.a)();function $e(e){var t=Ce(),n=Object(p.useRef)(),a=Object(p.useState)(Se.teamsIntegration||function(t){try{return e.auth.user.userPrincipalName===t}catch(n){return!1}}(Se.niels)),c=Object(i.a)(a,2),s=c[0],l=(c[1],Object(p.useState)("")),u=Object(i.a)(l,2),m=u[0],f=u[1],x=Object(p.useState)(""),y=Object(i.a)(x,2),w=y[0],E=y[1],k=Object(p.useState)(""),I=Object(i.a)(k,2),L=I[0],T=I[1],P=Object(p.useState)([]),D=Object(i.a)(P,2),N=D[0],M=D[1],B=Object(p.useState)(!1),U=Object(i.a)(B,2),H=(U[0],U[1],Object(p.useState)(!1)),J=Object(i.a)(H,2),F=(J[0],J[1],Object(p.useState)(!1)),Y=Object(i.a)(F,2),Z=Y[0],V=Y[1],K=Object(p.useState)(null),q=Object(i.a)(K,2),Q=(q[0],q[1]),$=Object(p.useState)({}),ee=Object(i.a)($,2),te=(ee[0],ee[1],Object(p.useState)({})),ne=Object(i.a)(te,2),ae=(ne[0],ne[1],Object(p.useState)([])),re=Object(i.a)(ae,2),oe=re[0],ie=(re[1],Object(p.useState)([])),ce=Object(i.a)(ie,2),le=ce[0],pe=ce[1],me=Object(p.useState)(""),fe=Object(i.a)(me,2),ve=fe[0],xe=fe[1],we=Object(p.useState)(1),ke=Object(i.a)(we,2),We=ke[0],Be=(ke[1],Object(p.useState)([])),Ge=Object(i.a)(Be,2),Ue=Ge[0],He=Ge[1],Je=Object(p.useState)([]),Fe=Object(i.a)(Je,2),qe=Fe[0],$e=Fe[1],et=Object(p.useState)([]),tt=Object(i.a)(et,2),nt=tt[0],at=tt[1],rt=Object(p.useState)(e.board),ot=Object(i.a)(rt,2),it=ot[0],ct=ot[1],st=Object(p.useState)(""),lt=Object(i.a)(st,2),ut=(lt[0],lt[1],Object(p.useState)("")),pt=Object(i.a)(ut,2),dt=(pt[0],pt[1],Object(p.useState)(!1)),mt=Object(i.a)(dt,2),ft=mt[0],ht=mt[1],gt=Object(p.useState)(""),bt=Object(i.a)(gt,2),vt=bt[0],xt=bt[1],yt=Object(p.useState)(null),Ot=Object(i.a)(yt,2),wt=Ot[0],jt=Ot[1],Et=Object(p.useState)(!1),kt=Object(i.a)(Et,2),St=kt[0],At=(kt[1],Object(p.useState)(!0)),Ct=Object(i.a)(At,2),It=(Ct[0],Ct[1],Object(p.useState)(!1)),Lt=Object(i.a)(It,2),Tt=Lt[0],Pt=(Lt[1],Object(p.useState)("")),Dt=Object(i.a)(Pt,2),Nt=Dt[0],zt=Dt[1],Rt=Object(p.useState)({lg:[]}),Mt=Object(i.a)(Rt,2),Wt=Mt[0],Bt=Mt[1],Gt=Object(p.useState)("pinned"),Ut=Object(i.a)(Gt,2),Ht=(Ut[0],Ut[1],Object(p.useState)(0)),Jt=Object(i.a)(Ht,2),Ft=Jt[0],Yt=Jt[1],Zt=Object(p.useState)([]),Vt=Object(i.a)(Zt,2),_t=Vt[0],Kt=(Vt[1],Object(p.useState)(!0)),qt=Object(i.a)(Kt,2),Qt=qt[0],Xt=qt[1],$t=Object(p.useState)(!Ce()),en=Object(i.a)($t,2),tn=en[0],nn=en[1],an=Object(p.useState)(!1),rn=Object(i.a)(an,2),on=rn[0],cn=rn[1],sn=Object(p.useState)(!0),ln=Object(i.a)(sn,2),un=ln[0],pn=(ln[1],Object(p.useState)(!1)),dn=Object(i.a)(pn,2),mn=dn[0],fn=dn[1],hn=Object(p.useState)("https://api.jumpto365.com/table/jumpto365.com/APAC%20DIGITAL%20WORKPLACE"),gn=Object(i.a)(hn,2),bn=(gn[0],gn[1],Object(p.useState)("")),vn=Object(i.a)(bn,2),xn=vn[0],yn=(vn[1],Object(p.useState)([])),On=Object(i.a)(yn,2),wn=(On[0],On[1]),jn=Object(p.useState)(!1),En=Object(i.a)(jn,2),kn=En[0],Sn=En[1],An=Object(p.useState)("lg"),Cn=Object(i.a)(An,2),In=Cn[0],Ln=Cn[1],Tn=Object(p.useState)(!1),Pn=Object(i.a)(Tn,2),Dn=Pn[0],Nn=Pn[1],zn=Object(p.useState)(!1),Rn=Object(i.a)(zn,2),Mn=Rn[0],Wn=Rn[1],Bn=Object(p.useState)(!0),Gn=Object(i.a)(Bn,2),Un=Gn[0],Hn=Gn[1],Jn=Object(p.useState)([]),Fn=Object(i.a)(Jn,2),Yn=Fn[0],Zn=Fn[1],Vn=Object(p.useState)(""),_n=Object(i.a)(Vn,2),Kn=_n[0],qn=_n[1],Qn=Object(p.useState)(!1),Xn=Object(i.a)(Qn,2),$n=Xn[0],ea=Xn[1];function ta(e){ct(e),window.location.href="/board/".concat(e)}function na(e){e&&Wn(!1),cn(e)}function aa(e){T(e),j.a.startsWith(e,".")||E(e)}var ra=function(e){j.a.keys(Wt).forEach((function(t){Wt[t].splice(e,1),Wt[t]=Wt[t].map((function(e,t){return e.i=t.toString(),e}))})),le.splice(e,1),Bt(Wt),pe(le),Yt(Ft+1)},oa=function(e,t){var n=j.a.cloneDeep(e);n.channel=t;var a=le.push(n);j.a.keys(Wt).forEach((function(t){a=Wt[t].length.toString(),Wt[t].push({team:e.id,x:0,y:2*a,w:2,h:2,i:a})})),Bt(Wt),na(!0),Yt(Ft+1),Sn(!1),pe(le)},ia=function(){var e;nn(e=!tn),Sn(!0),G(W.SEARCHCLICKED,{on:e}),Yt(Ft+1)};function ca(e,t){O.a.get(e).then((function(n){var a=n.data;f(a.titlegraphics);var r=[];if(a.grid){var o={},i={};a.grid.forEach((function(e){return e.forEach((function(e){e.groupSetting&&(o[e.groupSetting.title]={groupSetting:e.groupSetting,members:e.members},e.members&&e.members.forEach((function(t){var n=i[t]?i[t]:[];n.push(e.groupSetting),i[t]=n})))}))}));var c=j.a.keys(o).map((function(e){return Object(h.a)({title:e},o[e])}));wn(j.a.sortBy(c,["title"])),a.grid.forEach((function(n){return n.forEach((function(n){if(n.tile&&n.tile.title){var a=Object(h.a)({},n.tile);a.sortKey=j.a.toLower(n.tile.title),a.tableId=t,a.correlation=e+"#"+(a.key?a.key:a.title?a.title.toLowerCase():a.id);var o=i[n.id];a.references=o,r.push(a)}}))}))}M(j.a.sortBy(r,["sortKey"]))}))}function sa(e){return la.apply(this,arguments)}function la(){return(la=Object(o.a)(r.a.mark((function e(t){var n,a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=0,a=localStorage.getItem("memberships"),e.prev=4,!a||t){e.next=9;break}return i=JSON.parse(a),$e(i),e.abrupt("return");case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return ht(!0),e.next=16,de().catch((function(e){Ue.push({context:"readCache",error:e}),He(Ue)}));case 16:return(i=e.sent)&&!t?($e(i),localStorage.setItem("memberships",JSON.stringify(i)),ht(!1)):(n++,xt("Loading"),X((function(e){jt(e)})).then(function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue(t).catch((function(e){Ue.push({context:"saveCache",error:e}),He(Ue)}));case 2:localStorage.setItem("memberships",JSON.stringify(t)),0===--n&&ht(!1),G(W.MEMBERSHIPSREAD,{"count-memberships":t.length}),$e(t),xt("");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){--n<=0&&ht(!1),Ue.push({context:"OfficeGraph.teamMemberships()",error:e}),He(Ue),xt("")}))),e.abrupt("return");case 21:e.prev=21,e.t1=e.catch(0),Ue.push({context:"initGraph",error:e.t1}),He(Ue);case 25:case"end":return e.stop()}}),e,null,[[0,21],[4,11]])})))).apply(this,arguments)}function ua(e){if(!w)return!0;var t=e&&e.title&&-1!==e.title.toLowerCase().indexOf(w.toLowerCase());return t||(t=e&&e.inShort&&-1!==e.inShort.toLowerCase().indexOf(w.toLowerCase())),t||(t=e&&e.subTitle&&-1!==e.subTitle.toLowerCase().indexOf(w.toLowerCase())),t}function pa(){return(pa=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Dn){e.next=3;break}return console.log("not mounted, persistLayouts dropped"),e.abrupt("return");case 3:return console.log("persistLayouts"),e.next=6,he(se,ga(),{layouts:Wt,myTeams:le}).catch((function(e){Ue.push({context:"  writeLayouts",error:e}),He(Ue)}));case 6:Wn(!1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(p.useEffect)((function(){function e(){return(e=Object(o.a)(r.a.mark((function e(){var t,n,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return it&&(window.document.title="LAUNZH - "+it),s&&sa(!1),(t=Ae(window.location.href)).ztickyref&&xe(t.ztickyref),n=t.src?t.src:Se.defaultTableAPI,e.t0=Zn,e.next=8,ye().catch((function(){}));case 8:if(e.t1=e.sent,(0,e.t0)(e.t1),be().then((function(e){var t=[];e.forEach((function(e){if(j.a.endsWith(e.name.toLowerCase(),".json")){var n=e.name.split(".")[0];t.push({key:n,text:n})}})),at(t)})).catch((function(e){})),mn){e.next=18;break}return fn(!0),e.next=15,ge(se,ga()).catch((function(e){}));case 15:(a=e.sent)&&(pe(a.myTeams),Bt(a.layouts),Yt(Ft+1)),Nn(!0);case 18:if(zt(Se.defaultTableAPI),ca(n,Se.defaultTableKey),Kn){e.next=25;break}return e.next=23,_(se).catch((function(){}));case 23:(o=e.sent)&&qn(o.webUrl);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[Ft,it]);var da=w||0!==_t.length?[]:N,ma=w||0!==_t.length?[]:oe,fa=w||0!==_t.length?[]:qe;w||_t.length,ve&&new URL(ve);(w||_t.length>0)&&(N.forEach((function(e){ua(e)&&da.push(e)})),oe.forEach((function(e){ua(e.tile)&&ma.push(e)})),qe.forEach((function(e){(function(e){var t=!0;if(_t.length>0&&(t=!1,_t.forEach((function(n){switch(n.id){case"sharepoint":e.hasSharePoint&&(t=!0);break;case"teams":e.hasTeams&&(t=!0);break;case"yammer":e.hasYammer&&(t=!0);break;case"private":"Private"===e.visibility&&(t=!0);break;case"public":"Public"===e.visibility&&(t=!0)}}))),!t)return!1;if(!w)return!0;var n=e.data&&e.data.details?e.data.details:{},a=e.data&&e.data.channels?e.data.channels:[],r=n.displayName&&-1!==n.displayName.toLowerCase().indexOf(w.toLowerCase());return r||(r=n.description&&-1!==n.description.toLowerCase().indexOf(w.toLowerCase())),a.forEach((function(e){r||(r=e.displayName&&-1!==e.displayName.toLowerCase().indexOf(w.toLowerCase())),r||(r=e.description&&-1!==e.description.toLowerCase().indexOf(w.toLowerCase()))})),r})(e)&&fa.push(e)})),Ze&&(console.log("Postponing search trace"),clearTimeout(Ze)),console.log("Timeing search trace"),Ze=setTimeout((function(){console.log("sending search trace"),G(W.SEARCHING,Ve),Ze=null}),1e3));if(!e||!e.auth)return null;var ha=on?A.a[In]:null;return d.a.createElement("div",null,!t&&Se.components.header,d.a.createElement("div",null," ",0!==Ue.length&&d.a.createElement("div",null,d.a.createElement(C,{errors:Ue})),vt&&d.a.createElement("div",{style:{backgroundColor:"white",width:"100vw",position:"fixed",top:"0px",zIndex:2}},d.a.createElement(v.a,{percentComplete:wt,xlabel:"Example title",xdescription:vt})),d.a.createElement("img",{style:{display:"none",height:"64px",margin:"13px",position:"fixed",bottom:"0px",right:"0px"},src:m}),!Z&&d.a.createElement("div",{style:{display:"flex"}}," ",d.a.createElement("div",{style:{display:"xnone",paddingRight:"8px",position:"fixed",bottom:"0px",backgroundColor:"white"}},s&&d.a.createElement("div",null,d.a.createElement("i",{style:{cursor:"pointer",padding:"4px"},className:"ms-Icon ms-Icon--Refresh",onClick:function(){sa(!0)},"aria-hidden":"true"})," ",ft&&d.a.createElement(d.a.Fragment,null,"Loading"))),!t&&d.a.createElement("div",{style:{position:"fixed",right:0,top:0,zIndex:32,marginRight:"16px",width:"calc(100vw - 200px)"}},d.a.createElement("div",{style:{display:"flex"}},d.a.createElement("div",{style:{marginLeft:"16px",marginTop:"10px",flexGrow:1}}," ",!on&&d.a.createElement("div",{style:{display:"flex"}},d.a.createElement("div",{style:{flexGrow:1}},d.a.createElement(g.a,{disabled:St,placeholder:"Select board",selectedKey:it,xlabel:"View as",onChanged:function(e,t){ta(e.key)},options:nt.map((function(e){return{key:e.key,text:e.text}})),styles:{dropdown:{flexGrow:1,border:"1px"}}})),d.a.createElement("div",{style:{marginLeft:"16px",xmarginTop:"4px"}},d.a.createElement(R.a,{styles:{fontSize:"24px"},iconProps:{iconName:"Add"},ariaLabel:"Add",onClick:function(){return ea(!0)}})))),$n&&d.a.createElement(Ye,{onDismiss:function(){ea(!1)},onAdd:function(e){ta(e),ea(!1)}}),on&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{style:{marginTop:"16px",marginRight:"8px"}},"Screen width\xa0"),d.a.createElement("div",null,d.a.createElement(Ne,{selected:In,breakpoints:A.a,onSelect:function(e){Ln(e)}})),d.a.createElement("div",{style:{marginTop:"8px"}},d.a.createElement(R.a,{styles:{fontSize:"24px"},disabled:!Mn,iconProps:{iconName:"Save"},ariaLabel:"Save",onClick:function(){return function(){return pa.apply(this,arguments)}()}}))),d.a.createElement("div",{style:{padding:"16px",marginTop:"0px"}},"Edit"),d.a.createElement("div",{style:{marginTop:"16px"}},d.a.createElement(Ie.a,{checked:on,onChange:function(e,t){na(t),Yt(Ft+1)}})),d.a.createElement("div",{style:{marginTop:"4px"}},d.a.createElement(Le.a,{farItems:[{key:"info",text:"Info",ariaLabel:"Info",iconOnly:!0,iconProps:{iconName:"CollapseMenu"},onClick:function(){return console.log("Info")},subMenuProps:{items:[{key:"allBoards",text:"Boards",iconProps:{iconName:"AllApps"},onClick:function(){Object(Oe.b)("/boards")}},{key:"check",text:"Check",iconProps:{iconName:"ReceiptCheck"},onClick:function(){Object(Oe.b)("/check")}},{key:"onedrive",text:"OneDrive files",disabled:!Kn,iconProps:{iconName:"OneDriveLogo"},onClick:function(){window.open(Kn)}},{key:"signout",text:"Sign Out",iconProps:{iconName:"SignOut"},onClick:function(){e.signOut&&e.signOut()}},{key:"debug",text:"Debug",iconProps:{iconName:"SearchAndApps"},onClick:function(){Object(Oe.b)("/debug")}}]}}],ariaLabel:"Use left and right arrow keys to navigate between commands"})))),d.a.createElement("div",{style:{flexGrow:"1"}},d.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",marginTop:"8px"}},d.a.createElement("div",{style:{padding:"0px",marginLeft:"8px",flexGrow:1}})," "),d.a.createElement("div",{style:{position:"fixed",right:0,bottom:0,zIndex:32}},d.a.createElement("div",{style:{display:"flex"}},d.a.createElement("div",{style:{padding:"16px",marginTop:"0px"}},d.a.createElement("i",{ref:n,style:{cursor:"pointer",padding:"4px"},className:"ms-Icon ms-Icon--Add tilesearch",onClick:function(){ia()},"aria-hidden":"true"})))),d.a.createElement("div",{style:un?{backgroundColor:"#666666"}:{}},d.a.createElement("div",{style:on?{marginRight:"auto",marginLeft:"auto",width:ha,minHeight:"100vh",backgroundColor:"#ffffff"}:un?{marginRight:"auto",marginLeft:"auto",maxWidth:1200,minHeight:"100vh",backgroundColor:"#ffffff"}:{}},!Dn&&d.a.createElement("div",{style:{height:"90vh",marginTop:"40vh"}},d.a.createElement(Te.a,{label:"Assembling your board ..."})),Dn&&0===le.length&&Un&&d.a.createElement(ze.a,{messageBarType:Re.a.warning,isMultiline:!1,onDismiss:function(){Hn(!1)},dismissButtonAriaLabel:"Close",actions:d.a.createElement("div",null,d.a.createElement(Me.a,{onClick:function(){na(!0),Hn(!1),ia()}}," ","Add Tiles"))},"Hi, nothing on this board"),d.a.createElement(Pe.a,{target:n,positioningContainerProps:{directionalHint:De.a.topAutoEdge,doNotLayer:!1},ariaAlertText:"A Coachmark has appeared",ariaDescribedBy:"coachmark-desc1",ariaLabelledBy:"coachmark-label1",ariaDescribedByText:"Press enter or alt + C to open the Coachmark notification",ariaLabelledByText:"Coachmark notification"},"Welcome to the land of Coachmarks!"),d.a.createElement(A.b,{indexLaunzhContexts:Yn,tools:oe,layouts:Wt,persist:function(e){Dn?(Bt(e),Wn(!0)):console.log("not mounted, persistLayouts dropped")},editMode:on,getPin:function(e,t,n,a){var r=le[parseInt(e)];return d.a.createElement(Ee,{indexLaunzhContexts:Yn,editMode:on,refreshCounter:a,key:e,width:t,height:n,team:r,pinId:parseInt(e),isPinned:!0,onRemovePin:ra})},onRemovePin:ra,fixedWidth:ha,onTileClick:function(e){Q(e),V(!0)}}))),St&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{style:{textAlign:"right"}},d.a.createElement("i",{style:{cursor:"pointer",padding:"4px"},class:"ms-Icon ms-Icon--OpenInNewWindow",onClick:function(){window.open(Nt,"_blank")},"aria-hidden":"true"})),d.a.createElement("iframe",{style:{border:"0",height:"calc(100vh - 150px",width:"95vw"},src:Nt})),d.a.createElement(z.a,{titleAriaId:1,isOpen:kn,onDismiss:function(){return Sn(!1)},isBlocking:!1,containerClassName:Qe.container,xdragOptions:_e},d.a.createElement("div",{style:{display:"flex"}},d.a.createElement("div",{style:{flexGrow:1}}),d.a.createElement("div",null,d.a.createElement(R.a,{styles:Xe,iconProps:Ke,ariaLabel:"Close popup modal",onClick:function(){return Sn(!1)}}))),d.a.createElement("div",{className:Qe.body},d.a.createElement(b.a,{autoFocus:!1,disabled:St,xlabel:"Filter",value:L,onChange:function(e,t){aa(t)},placeholder:"Start typing any characters to filter. If you turn on 'Show details' you get a highlight match ",iconProps:{iconName:"Filter"}}),d.a.createElement("div",{style:{display:"flex"}},d.a.createElement("div",{style:{padding:"16px",marginTop:"0px"}},"Show details"),d.a.createElement("div",{style:{marginTop:"16px"}},d.a.createElement(Ie.a,{checked:Qt,onChange:function(e,t){var n;Xt(n=t),G(W.DETAILSTOGGLED,{on:n}),Yt(Ft+1)}})),d.a.createElement("div",null)),d.a.createElement(je,{onSaveTeam:oa,onSaveChannel:function(e,t){oa(e,t)},refreshCounter:Ft,tiles:da,details:Qt,memberShips:fa,filter:w,highlightStyle:{backgroundColor:"yellow"}}))),!St&&!s&&d.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},0===da.length&&d.a.createElement("div",null,d.a.createElement("h2",null,'Sorry. No matches for "',w,'"')),da.map((function(t,n){if(xn){var a=!1;if(!t.references)return null;if(t.references.forEach((function(e){e.title===xn&&(a=!0)})),!a)return null}return d.a.createElement(S,{tileSize:We,key:n,filter:w,highlightStyle:{backgroundColor:"yellow",color:"#333"},tile:t,onPinnedClicked:function(e){e.tile&&oa(e.tile)},onClick:function(t){if(window.amplitude&&(e&&e.auth&&e.auth.user&&e.auth.user.userPrincipalName&&window.amplitude.getInstance().identify(e.auth.user.userPrincipalName),window.amplitude.getInstance().logEvent("tool",t)),t.jumpto&&!t.messageBeforeLaunch)return window.open(t.jumpto,"_blank");Q(t),V(!0)}})})))),Tt&&d.a.createElement("div",{style:{borderLeft:"1px solid #dddddd",borderTop:"1px solid #dddddd",padding:"8px",float:"right",minWidth:"300px"}},d.a.createElement("div",{style:{padding:"0px"}},d.a.createElement(b.a,{label:"Filter",value:L,onChange:function(e,t){aa(t)},placeholder:"Filter the list of tools",iconProps:{iconName:"Filter"}}))))),!1);function ga(){var t=e.board?e.board:"default";return"".concat(t,".json")}}window.Office.initialize=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:!0;case 1:case"end":return e.stop()}}),e)})));var et,tt,nt={moveMenuItemText:"Move",closeMenuItemText:"Close",menu:D.a},at={iconName:"Cancel"},rt=Object(N.D)(),ot=Object(N.H)({container:{display:"flex",flexFlow:"column nowrap",alignItems:"stretch"},header:[rt.fonts.xLargePlus,{flex:"1 1 auto",borderTop:"4px solid ".concat(rt.palette.themePrimary),color:rt.palette.neutralPrimary,display:"flex",alignItems:"center",fontWeight:N.d.semibold,padding:"12px 12px 14px 24px"}],body:{flex:"4 4 auto",padding:"0 24px 24px 24px",minWidth:"95vw",minHeight:"90vh",overflowY:"hidden",selectors:{p:{margin:"14px 0"},"p:first-child":{marginTop:0},"p:last-child":{marginBottom:0}}}}),it={root:{color:rt.palette.neutralPrimary,marginLeft:"auto",marginTop:"4px",marginRight:"2px"},rootHovered:{color:rt.palette.neutralDark}};Object(x.a)();function ct(e){var t=Ce(),n=Object(p.useRef)(),a=Object(p.useState)(Se.teamsIntegration||function(t){try{return e.auth.user.userPrincipalName===t}catch(n){return!1}}(Se.niels)),c=Object(i.a)(a,2),s=c[0],l=(c[1],Object(p.useState)("")),u=Object(i.a)(l,2),m=u[0],f=u[1],x=Object(p.useState)(""),y=Object(i.a)(x,2),w=y[0],E=y[1],k=Object(p.useState)(""),S=Object(i.a)(k,2),I=S[0],L=S[1],T=Object(p.useState)([]),P=Object(i.a)(T,2),D=P[0],N=P[1],M=Object(p.useState)(!1),B=Object(i.a)(M,2),U=(B[0],B[1],Object(p.useState)(!1)),H=Object(i.a)(U,2),J=(H[0],H[1],Object(p.useState)(!1)),F=Object(i.a)(J,2),Y=F[0],Z=F[1],V=Object(p.useState)(null),K=Object(i.a)(V,2),q=(K[0],K[1]),Q=Object(p.useState)({}),$=Object(i.a)(Q,2),ee=($[0],$[1],Object(p.useState)({})),te=Object(i.a)(ee,2),ne=(te[0],te[1],Object(p.useState)([])),ae=Object(i.a)(ne,2),re=ae[0],oe=(ae[1],Object(p.useState)([])),ie=Object(i.a)(oe,2),ce=ie[0],le=ie[1],pe=Object(p.useState)(""),me=Object(i.a)(pe,2),fe=me[0],ve=me[1],xe=Object(p.useState)(1),we=Object(i.a)(xe,2),ke=(we[0],we[1],Object(p.useState)([])),We=Object(i.a)(ke,2),Be=We[0],Ge=We[1],Ue=Object(p.useState)([]),He=Object(i.a)(Ue,2),Je=He[0],Fe=He[1],Ze=Object(p.useState)([]),Ve=Object(i.a)(Ze,2),_e=Ve[0],Ke=Ve[1],qe=Object(p.useState)(e.board),Qe=Object(i.a)(qe,2),Xe=Qe[0],$e=Qe[1],rt=Object(p.useState)(""),ct=Object(i.a)(rt,2),st=(ct[0],ct[1],Object(p.useState)("")),lt=Object(i.a)(st,2),ut=(lt[0],lt[1],Object(p.useState)(!1)),pt=Object(i.a)(ut,2),dt=pt[0],mt=pt[1],ft=Object(p.useState)(""),ht=Object(i.a)(ft,2),gt=ht[0],bt=ht[1],vt=Object(p.useState)(null),xt=Object(i.a)(vt,2),yt=xt[0],Ot=xt[1],wt=Object(p.useState)(!1),jt=Object(i.a)(wt,2),Et=jt[0],kt=(jt[1],Object(p.useState)(!0)),St=Object(i.a)(kt,2),At=(St[0],St[1],Object(p.useState)(!1)),Ct=Object(i.a)(At,2),It=Ct[0],Lt=(Ct[1],Object(p.useState)("")),Tt=Object(i.a)(Lt,2),Pt=Tt[0],Dt=Tt[1],Nt=Object(p.useState)({lg:[]}),zt=Object(i.a)(Nt,2),Rt=zt[0],Mt=zt[1],Wt=Object(p.useState)("pinned"),Bt=Object(i.a)(Wt,2),Gt=(Bt[0],Bt[1],Object(p.useState)(0)),Ut=Object(i.a)(Gt,2),Ht=Ut[0],Jt=Ut[1],Ft=Object(p.useState)([]),Yt=Object(i.a)(Ft,2),Zt=Yt[0],Vt=(Yt[1],Object(p.useState)(!0)),_t=Object(i.a)(Vt,2),Kt=_t[0],qt=_t[1],Qt=Object(p.useState)(!Ce()),Xt=Object(i.a)(Qt,2),$t=Xt[0],en=Xt[1],tn=Object(p.useState)(!1),nn=Object(i.a)(tn,2),an=nn[0],rn=nn[1],on=Object(p.useState)(!0),cn=Object(i.a)(on,2),sn=cn[0],ln=(cn[1],Object(p.useState)(!1)),un=Object(i.a)(ln,2),pn=un[0],dn=un[1],mn=Object(p.useState)("https://api.jumpto365.com/table/jumpto365.com/APAC%20DIGITAL%20WORKPLACE"),fn=Object(i.a)(mn,2),hn=(fn[0],fn[1],Object(p.useState)("")),gn=Object(i.a)(hn,2),bn=(gn[0],gn[1],Object(p.useState)([])),vn=Object(i.a)(bn,2),xn=(vn[0],vn[1]),yn=Object(p.useState)(!1),On=Object(i.a)(yn,2),wn=On[0],jn=On[1],En=Object(p.useState)("lg"),kn=Object(i.a)(En,2),Sn=kn[0],An=kn[1],Cn=Object(p.useState)(!1),In=Object(i.a)(Cn,2),Ln=In[0],Tn=In[1],Pn=Object(p.useState)(!1),Dn=Object(i.a)(Pn,2),Nn=Dn[0],zn=Dn[1],Rn=Object(p.useState)(!0),Mn=Object(i.a)(Rn,2),Wn=Mn[0],Bn=Mn[1],Gn=Object(p.useState)([]),Un=Object(i.a)(Gn,2),Hn=Un[0],Jn=Un[1],Fn=Object(p.useState)(""),Yn=Object(i.a)(Fn,2),Zn=Yn[0],Vn=Yn[1],_n=Object(p.useState)(!1),Kn=Object(i.a)(_n,2),qn=Kn[0],Qn=Kn[1];function Xn(e){$e(e),window.location.href="/board/".concat(e)}function $n(e){e&&zn(!1),rn(e)}function ea(e){L(e),j.a.startsWith(e,".")||E(e)}var ta=function(e){j.a.keys(Rt).forEach((function(t){Rt[t].splice(e,1),Rt[t]=Rt[t].map((function(e,t){return e.i=t.toString(),e}))})),ce.splice(e,1),Mt(Rt),le(ce),Jt(Ht+1)},na=function(e,t){var n=j.a.cloneDeep(e);n.channel=t;var a=ce.push(n);j.a.keys(Rt).forEach((function(t){a=Rt[t].length.toString(),Rt[t].push({team:e.id,x:0,y:2*a,w:2,h:2,i:a})})),Mt(Rt),$n(!0),Jt(Ht+1),jn(!1),le(ce)},aa=function(){var e;en(e=!$t),jn(!0),G(W.SEARCHCLICKED,{on:e}),Jt(Ht+1)};function ra(e,t){O.a.get(e).then((function(n){var a=n.data;f(a.titlegraphics);var r=[];if(a.grid){var o={},i={};a.grid.forEach((function(e){return e.forEach((function(e){e.groupSetting&&(o[e.groupSetting.title]={groupSetting:e.groupSetting,members:e.members},e.members&&e.members.forEach((function(t){var n=i[t]?i[t]:[];n.push(e.groupSetting),i[t]=n})))}))}));var c=j.a.keys(o).map((function(e){return Object(h.a)({title:e},o[e])}));xn(j.a.sortBy(c,["title"])),a.grid.forEach((function(n){return n.forEach((function(n){if(n.tile&&n.tile.title){var a=Object(h.a)({},n.tile);a.sortKey=j.a.toLower(n.tile.title),a.tableId=t,a.correlation=e+"#"+(a.key?a.key:a.title?a.title.toLowerCase():a.id);var o=i[n.id];a.references=o,r.push(a)}}))}))}N(j.a.sortBy(r,["sortKey"]))}))}function oa(e){return ia.apply(this,arguments)}function ia(){return(ia=Object(o.a)(r.a.mark((function e(t){var n,a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=0,a=localStorage.getItem("memberships"),e.prev=4,!a||t){e.next=9;break}return i=JSON.parse(a),Fe(i),e.abrupt("return");case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return mt(!0),e.next=16,de().catch((function(e){Be.push({context:"readCache",error:e}),Ge(Be)}));case 16:return(i=e.sent)&&!t?(Fe(i),localStorage.setItem("memberships",JSON.stringify(i)),mt(!1)):(n++,bt("Loading"),X((function(e){Ot(e)})).then(function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue(t).catch((function(e){Be.push({context:"saveCache",error:e}),Ge(Be)}));case 2:localStorage.setItem("memberships",JSON.stringify(t)),0===--n&&mt(!1),G(W.MEMBERSHIPSREAD,{"count-memberships":t.length}),Fe(t),bt("");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){--n<=0&&mt(!1),Be.push({context:"OfficeGraph.teamMemberships()",error:e}),Ge(Be),bt("")}))),e.abrupt("return");case 21:e.prev=21,e.t1=e.catch(0),Be.push({context:"initGraph",error:e.t1}),Ge(Be);case 25:case"end":return e.stop()}}),e,null,[[0,21],[4,11]])})))).apply(this,arguments)}function ca(e){if(!w)return!0;var t=e&&e.title&&-1!==e.title.toLowerCase().indexOf(w.toLowerCase());return t||(t=e&&e.inShort&&-1!==e.inShort.toLowerCase().indexOf(w.toLowerCase())),t||(t=e&&e.subTitle&&-1!==e.subTitle.toLowerCase().indexOf(w.toLowerCase())),t}function sa(){return(sa=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ln){e.next=3;break}return console.log("not mounted, persistLayouts dropped"),e.abrupt("return");case 3:return console.log("persistLayouts"),e.next=6,he(se,ma(),{layouts:Rt,myTeams:ce}).catch((function(e){Be.push({context:"  writeLayouts",error:e}),Ge(Be)}));case 6:zn(!1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(p.useEffect)((function(){function e(){return(e=Object(o.a)(r.a.mark((function e(){var t,n,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xe&&(window.document.title="LAUNZH - "+Xe),s&&oa(!1),(t=Ae(window.location.href)).ztickyref&&ve(t.ztickyref),n=t.src?t.src:Se.defaultTableAPI,e.t0=Jn,e.next=8,ye().catch((function(){}));case 8:if(e.t1=e.sent,(0,e.t0)(e.t1),be().then((function(e){var t=[];e.forEach((function(e){if(j.a.endsWith(e.name.toLowerCase(),".json")){var n=e.name.split(".")[0];t.push({key:n,text:n})}})),Ke(t)})).catch((function(e){})),pn){e.next=18;break}return dn(!0),e.next=15,ge(se,ma()).catch((function(e){}));case 15:(a=e.sent)&&(le(a.myTeams),Mt(a.layouts),Jt(Ht+1)),Tn(!0);case 18:if(Dt(Se.defaultTableAPI),ra(n,Se.defaultTableKey),Zn){e.next=25;break}return e.next=23,_(se).catch((function(){}));case 23:(o=e.sent)&&Vn(o.webUrl);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[Ht,Xe]);var la=w||0!==Zt.length?[]:D,ua=w||0!==Zt.length?[]:re,pa=w||0!==Zt.length?[]:Je;w||Zt.length,fe&&new URL(fe);(w||Zt.length>0)&&(D.forEach((function(e){ca(e)&&la.push(e)})),re.forEach((function(e){ca(e.tile)&&ua.push(e)})),Je.forEach((function(e){(function(e){var t=!0;if(Zt.length>0&&(t=!1,Zt.forEach((function(n){switch(n.id){case"sharepoint":e.hasSharePoint&&(t=!0);break;case"teams":e.hasTeams&&(t=!0);break;case"yammer":e.hasYammer&&(t=!0);break;case"private":"Private"===e.visibility&&(t=!0);break;case"public":"Public"===e.visibility&&(t=!0)}}))),!t)return!1;if(!w)return!0;var n=e.data&&e.data.details?e.data.details:{},a=e.data&&e.data.channels?e.data.channels:[],r=n.displayName&&-1!==n.displayName.toLowerCase().indexOf(w.toLowerCase());return r||(r=n.description&&-1!==n.description.toLowerCase().indexOf(w.toLowerCase())),a.forEach((function(e){r||(r=e.displayName&&-1!==e.displayName.toLowerCase().indexOf(w.toLowerCase())),r||(r=e.description&&-1!==e.description.toLowerCase().indexOf(w.toLowerCase()))})),r})(e)&&pa.push(e)})),et&&(console.log("Postponing search trace"),clearTimeout(et)),console.log("Timeing search trace"),et=setTimeout((function(){console.log("sending search trace"),G(W.SEARCHING,tt),et=null}),1e3));if(!e||!e.auth)return null;var da=an?A.a[Sn]:null;return d.a.createElement("div",null,!t&&Se.components.header,d.a.createElement("div",null," ",0!==Be.length&&d.a.createElement("div",null,d.a.createElement(C,{errors:Be})),gt&&d.a.createElement("div",{style:{backgroundColor:"white",width:"100vw",position:"fixed",top:"0px",zIndex:2}},d.a.createElement(v.a,{percentComplete:yt,xlabel:"Example title",xdescription:gt})),d.a.createElement("img",{style:{display:"none",height:"64px",margin:"13px",position:"fixed",bottom:"0px",right:"0px"},src:m}),!Y&&d.a.createElement("div",{style:{display:"flex"}}," ",d.a.createElement("div",{style:{display:"xnone",paddingRight:"8px",position:"fixed",bottom:"0px",backgroundColor:"white"}},s&&d.a.createElement("div",null,d.a.createElement("i",{style:{cursor:"pointer",padding:"4px"},className:"ms-Icon ms-Icon--Refresh",onClick:function(){oa(!0)},"aria-hidden":"true"})," ",dt&&d.a.createElement(d.a.Fragment,null,"Loading"))),!t&&d.a.createElement("div",{style:{position:"fixed",right:0,top:0,zIndex:32,marginRight:"16px",width:"calc(100vw - 200px)"}},d.a.createElement("div",{style:{display:"flex"}},d.a.createElement("div",{style:{marginLeft:"16px",marginTop:"10px",flexGrow:1}}," ",!an&&d.a.createElement("div",{style:{display:"flex"}},d.a.createElement("div",{style:{flexGrow:1}},d.a.createElement(g.a,{hidden:!0,disabled:Et,placeholder:"Select board",selectedKey:Xe,xlabel:"View as",onChanged:function(e,t){Xn(e.key)},options:_e.map((function(e){return{key:e.key,text:e.text}})),styles:{dropdown:{flexGrow:1,border:"1px"}}})),d.a.createElement("div",{style:{marginLeft:"16px",xmarginTop:"4px"}},d.a.createElement(R.a,{styles:{fontSize:"24px"},iconProps:{iconName:"Add"},ariaLabel:"Add",onClick:function(){return Qn(!0)}})))),qn&&d.a.createElement(Ye,{onDismiss:function(){Qn(!1)},onAdd:function(e){Xn(e),Qn(!1)}}),an&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{style:{marginTop:"16px",marginRight:"8px"}},"Screen width\xa0"),d.a.createElement("div",null,d.a.createElement(Ne,{selected:Sn,breakpoints:A.a,onSelect:function(e){An(e)}})),d.a.createElement("div",{style:{marginTop:"8px"}},d.a.createElement(R.a,{styles:{fontSize:"24px"},disabled:!Nn,iconProps:{iconName:"Save"},ariaLabel:"Save",onClick:function(){return function(){return sa.apply(this,arguments)}()}}))),!1,d.a.createElement("div",{style:{marginTop:"4px"}},d.a.createElement(Le.a,{farItems:[{key:"info",text:"Info",ariaLabel:"Info",iconOnly:!0,iconProps:{iconName:"CollapseMenu"},onClick:function(){return console.log("Info")},subMenuProps:{items:[{key:"check",text:"Check",iconProps:{iconName:"ReceiptCheck"},onClick:function(){Object(Oe.b)("/check")}},{key:"signout",text:"Sign Out",iconProps:{iconName:"SignOut"},onClick:function(){e.signOut&&e.signOut()}},{key:"debug",text:"Debug",iconProps:{iconName:"SearchAndApps"},onClick:function(){Object(Oe.b)("/debug")}}]}}],ariaLabel:"Use left and right arrow keys to navigate between commands"})))),d.a.createElement("div",{style:{flexGrow:"1"}},d.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",marginTop:"8px"}},d.a.createElement("div",{style:{padding:"0px",marginLeft:"8px",flexGrow:1}})," "),d.a.createElement("div",{style:{position:"fixed",right:0,bottom:0,zIndex:32}},!1),d.a.createElement("div",{style:sn?{backgroundColor:"#666666"}:{}},d.a.createElement("div",{style:an?{marginRight:"auto",marginLeft:"auto",width:da,minHeight:"100vh",backgroundColor:"#ffffff"}:sn?{marginRight:"auto",marginLeft:"auto",maxWidth:1200,minHeight:"100vh",backgroundColor:"#ffffff"}:{}},!Ln&&d.a.createElement("div",{style:{height:"90vh",marginTop:"40vh"}},d.a.createElement(Te.a,{label:"Assembling your board ..."})),Ln&&0===ce.length&&Wn&&d.a.createElement(ze.a,{messageBarType:Re.a.warning,isMultiline:!1,onDismiss:function(){Bn(!1)},dismissButtonAriaLabel:"Close",actions:d.a.createElement("div",null,d.a.createElement(Me.a,{onClick:function(){$n(!0),Bn(!1),aa()}}," ","Add Tiles"))},"Hi, nothing on this board"),d.a.createElement(Pe.a,{target:n,positioningContainerProps:{directionalHint:De.a.topAutoEdge,doNotLayer:!1},ariaAlertText:"A Coachmark has appeared",ariaDescribedBy:"coachmark-desc1",ariaLabelledBy:"coachmark-label1",ariaDescribedByText:"Press enter or alt + C to open the Coachmark notification",ariaLabelledByText:"Coachmark notification"},"Welcome to the land of Coachmarks!"),d.a.createElement(A.b,{indexLaunzhContexts:Hn,tools:re,layouts:Rt,persist:function(e){Ln?(Mt(e),zn(!0)):console.log("not mounted, persistLayouts dropped")},editMode:an,getPin:function(e,t,n,a){var r=ce[parseInt(e)];return d.a.createElement(Ee,{indexLaunzhContexts:Hn,editMode:an,refreshCounter:a,key:e,width:t,height:n,team:r,pinId:parseInt(e),isPinned:!0,onRemovePin:ta})},onRemovePin:ta,fixedWidth:da,onTileClick:function(e){q(e),Z(!0)}}))),Et&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{style:{textAlign:"right"}},d.a.createElement("i",{style:{cursor:"pointer",padding:"4px"},class:"ms-Icon ms-Icon--OpenInNewWindow",onClick:function(){window.open(Pt,"_blank")},"aria-hidden":"true"})),d.a.createElement("iframe",{style:{border:"0",height:"calc(100vh - 150px",width:"95vw"},src:Pt})),d.a.createElement(z.a,{titleAriaId:1,isOpen:wn,onDismiss:function(){return jn(!1)},isBlocking:!1,containerClassName:ot.container,xdragOptions:nt},d.a.createElement("div",{style:{display:"flex"}},d.a.createElement("div",{style:{flexGrow:1}}),d.a.createElement("div",null,d.a.createElement(R.a,{styles:it,iconProps:at,ariaLabel:"Close popup modal",onClick:function(){return jn(!1)}}))),d.a.createElement("div",{className:ot.body},d.a.createElement(b.a,{autoFocus:!1,disabled:Et,xlabel:"Filter",value:I,onChange:function(e,t){ea(t)},placeholder:"Start typing any characters to filter. If you turn on 'Show details' you get a highlight match ",iconProps:{iconName:"Filter"}}),d.a.createElement("div",{style:{display:"flex"}},d.a.createElement("div",{style:{padding:"16px",marginTop:"0px"}},"Show details"),d.a.createElement("div",{style:{marginTop:"16px"}},d.a.createElement(Ie.a,{checked:Kt,onChange:function(e,t){var n;qt(n=t),G(W.DETAILSTOGGLED,{on:n}),Jt(Ht+1)}})),d.a.createElement("div",null)),d.a.createElement(je,{onSaveTeam:na,onSaveChannel:function(e,t){na(e,t)},refreshCounter:Ht,tiles:la,details:Kt,memberShips:pa,filter:w,highlightStyle:{backgroundColor:"yellow"}})))),It&&d.a.createElement("div",{style:{borderLeft:"1px solid #dddddd",borderTop:"1px solid #dddddd",padding:"8px",float:"right",minWidth:"300px"}},d.a.createElement("div",{style:{padding:"0px"}},d.a.createElement(b.a,{label:"Filter",value:I,onChange:function(e,t){ea(t)},placeholder:"Filter the list of tools",iconProps:{iconName:"Filter"}}))))),!1);function ma(){var t=e.board?e.board:"default";return"".concat(t,".json")}}window.Office.initialize=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:!0;case 1:case"end":return e.stop()}}),e)})));n(545);var st="getAccessToken",lt="restoreUrl",ut="getGraphUser",pt="login",dt="access_token",mt="access_expires";function ft(e){return("localhost"===window.location.hostname?window.location.protocol:"https:")+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+"/"+e}function ht(){var e="https://login.microsoftonline.com/".concat(Se.directoryId,"/oauth2/v2.0/authorize"),t=Se.clientId,n=Se.scopes,a=ft(""),r="".concat(e,"?client_id=").concat(t,"&prompt=select_account&response_type=token&redirect_uri=").concat(a,"&response_mode=").concat("fragment","&scope=").concat(n,"&nonce=1");window.location.href=r}function gt(){var e=ft("signedout"),t="https://login.microsoftonline.com/".concat(Se.directoryId,"/oauth2/v2.0/logout?post_logout_redirect_uri=").concat(e);sessionStorage.removeItem(dt),sessionStorage.removeItem(mt),window.location.href=t}function bt(e,t,n){return new Promise((function(n,a){var r=ft(""),o="https://login.microsoftonline.com/".concat(e.directoryId,"/oauth2/v2.0/authorize"),i=e.clientId,c=e.scopes,s="",l=function(e){if(!e)return{};var t={},n=e.split("#");if(n.length>1)for(var a=n[1].split("&"),r=0;r<a.length;r++){var o=a[r].split("=");t[o[0]]=decodeURIComponent(o[1])}return t}(window.location.href),u=function(e){if(!e)return{};var t={},n=e.split("?");if(n.length>1)for(var a=n[1].split("&"),r=0;r<a.length;r++){var o=a[r].split("=");t[o[0]]=decodeURIComponent(o[1])}return t}(window.location.href);if(l.id_token)s=st;else if(l.access_token)s=lt;else if(l.login)s=pt;else if(""===s)if(sessionStorage.getItem(dt))s=function(){try{var e=sessionStorage.getItem(mt),t=P()(e);return P()().diff(t)>0}catch(n){return!0}}()?st:ut;else if(s=st,t)return t(null,null,!0);if(l.error||u.error){var p=!1;switch(l.error?l.error:u.error){case"interaction_required":if(t)return void t(l,u,!0);sessionStorage.removeItem("accesstoken"),sessionStorage.removeItem("idtoken");var d="".concat(o,"?client_id=").concat(i,"&response_type=").concat("id_token","&redirect_uri=").concat(r,"&response_mode=").concat("fragment","&scope=").concat(c,"&nonce=1");return void(window.location.href=d);case"consent_required":t&&t(null,null,!0),sessionStorage.removeItem("accesstoken"),sessionStorage.removeItem("idtoken");d="".concat(o,"?client_id=").concat(i,"&prompt=consent&response_type=token&redirect_uri=").concat(r,"&response_mode=").concat("fragment","&scope=").concat(c,"&nonce=1");return void(window.location.href=d);case"invalid_request":case"unsupported_response_type":case"access_denied":break;default:return void(sessionStorage.setItem("returnto","/")&&(window.location.href="#login"))}if(!p)return void a(l.error_description?l.error_description:u.error)}switch(s){case pt:sessionStorage.setItem("returnto",window.location.href);d="".concat(o,"?client_id=").concat(i,"&prompt=none&response_type=token&redirect_uri=").concat(r,"&response_mode=").concat("fragment","&scope=").concat(c,"&nonce=1");return void(window.location.href=d);case st:sessionStorage.setItem("returnto",window.location.href);d="".concat(o,"?client_id=").concat(i,"&prompt=none&response_type=token&redirect_uri=").concat(r,"&response_mode=").concat("fragment","&scope=").concat(c);return void(window.location.href=d);case ut:sessionStorage.removeItem("returnto"),O.a.get("https://graph.microsoft.com/v1.0/me",{headers:{"content-type":"application/json",authorization:"Bearer ".concat(sessionStorage.getItem(dt))}}).then((function(e){n({user:e.data})})).catch((function(e){e&&e.response&&e.response.data&&e.response.data.error?n({error:e.response.data.error.message}):n({error:e})}));break;case lt:if(l.access_token){sessionStorage.setItem(dt,l.access_token);var m=P()().add(l.expires_in,"s");return sessionStorage.setItem(mt,m.toISOString()),void(sessionStorage.getItem("returnto")&&(window.location.href=sessionStorage.getItem("returnto")))}window.location.reload(),n();break;default:n({error:"Sorry to have put you in this situation, but our authentication logic is not able to detect the next step to taka so we cannot let you in"})}}))}function vt(e){return new Promise((function(t,n){if(!e)return n("Mssing upn");var a=j.a.split(e,"@");if(a.length<2)return n("Mssing domain part");var r=j.a.toLower(a[1]);O.a.get("https://blob.jumpto365.com/licenses/".concat(r,".license.json")).then((function(e){t(e.data)})).catch((function(e){n(e)}))}))}var xt=n(596),yt=n(618),Ot=n(608),wt=n(92),jt=n(88),Et=n(615),kt=n(283),St=n(595),At=n(621),Ct=n(602),It={ariaLabel:"More commands"},Lt=Object(N.D)(),Tt=Object(N.I)({backgroundColor:Lt.palette.neutralLight});Object(N.I)({display:"flex",flexWrap:"wrap"}),d.a.Component;var Pt=p.createContext();Pt.Consumer;n.d(t,"default",(function(){return Dt}));var Dt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={hasError:!1},a}return Object(s.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,info:t}),console.log("componentDidCatch",e,t)}},{key:"render",value:function(){var e=this;return this.state.hasError?d.a.createElement("div",{className:"pageBody"},d.a.createElement("h1",{className:"errorCenterHeader"},"Sorry! Something not working as expected"),this.state.error&&this.state.error.message&&d.a.createElement("h2",null,this.state.error.message),d.a.createElement("div",{className:"errorCenterHeader"},d.a.createElement("div",null,d.a.createElement(He.a,{style:{margin:"16px",width:"300px"},primary:!0,text:"Visit our Help Center",onClick:function(){window.open("https://jumpto365.zendesk.com/hc/en-us","_blank")}})),d.a.createElement("div",null,d.a.createElement(He.a,{style:{margin:"16px",width:"300px"},text:"Check service availabiliy",onClick:function(){window.open("https://uptime.com/s/overview","_blank")}})),d.a.createElement("div",null,d.a.createElement(He.a,{style:{margin:"16px",width:"300px"},text:"View error details",onClick:function(){e.setState({viewDetails:!0})}}))),this.state.info&&this.state.info.componentStack&&this.state.viewDetails?d.a.createElement("div",null,d.a.createElement("textarea",{style:{width:"100%"},readOnly:!0,rows:"30",cols:"80",value:this.state.info.componentStack})," "):null):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(d.a.Component),Nt=Object(N.G)({defaultFontStyle:{fontFamily:"Monaco, Menlo, Consolas",fontWeight:"regular"},fonts:{small:{fontSize:"11px"},medium:{fontSize:"13px"},large:{fontSize:"20px",fontWeight:"semibold"},xLarge:{fontSize:"22px",fontWeight:"semibold"}}});function zt(e){return d.a.createElement("div",{style:{minHeight:"100vh",minWidth:"100vw"}},d.a.createElement("div",{style:{maxWidth:"1200px",marginLeft:"auto",marginRight:"auto"}},e.children))}function Rt(){return window.location.href="/home",null}function Mt(){return function(){var e=ft(""),t="https://login.microsoftonline.com/".concat("organizations","/v2.0/adminconsent?client_id=").concat(Se.clientId,"&state=12345&redirect_uri=").concat(e,"&scope=").concat(Se.scopes);window.location.href=t}(),null}function Wt(){return d.a.createElement(zt,null,'Thank you for the consent"')}function Bt(){return d.a.createElement(zt,null,"You have been signed out")}function Gt(){return gt(),null}function Ut(){return d.a.createElement(zt,null,"Page not found")}function Ht(){return d.a.createElement(zt,null,d.a.createElement("div",null,d.a.createElement("div",null,d.a.createElement("a",{href:"/getadminconsent"},"Get Admin Consent")," "),d.a.createElement("div",null,d.a.createElement("a",{href:"/signout"},"Sign Out")," "),d.a.createElement("div",null,d.a.createElement("a",{href:"/selectaccount"},"Select Account")," "),d.a.createElement("div",null),d.a.createElement("div",null),d.a.createElement("div",null),d.a.createElement("div",null)))}function Jt(e){var t=Object(p.useState)(!0),n=Object(i.a)(t,2),a=(n[0],n[1]);return e.interactionRequired?d.a.createElement("div",{style:{position:"fixed",width:"100vw",zIndex:10}},d.a.createElement(ze.a,{messageBarType:Re.a.error,isMultiline:!1,onDismiss:function(){a(!1)},dismissButtonAriaLabel:"Close",actions:d.a.createElement("div",null,!Ce()&&d.a.createElement(Me.a,{onClick:function(){ht()}}," ","Sign in"),Ce()&&d.a.createElement(d.a.Fragment,null,d.a.createElement("a",{href:"#",target:"_blank"},"Open in new tab and sign in"),d.a.createElement(Me.a,{onClick:function(){window.Office.context.ui.displayDialogAsync("https://localhost:3002")}}," ","Reload")))},"We need to sign you in")):null}function Ft(){var e=Object(p.useState)(null),t=Object(i.a)(e,2),n=t[0],a=t[1],c=Object(p.useState)(null),s=Object(i.a)(c,2),l=(s[0],s[1]),u=Object(p.useState)(!1),m=Object(i.a)(u,2),f=m[0],h=m[1];return Object(p.useEffect)((function(){new Promise(function(){var e=Object(o.a)(r.a.mark((function e(t,n){var a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,bt(Se,(function(e,n,a){return t({interactionRequired:a})})).catch((function(e){n(e)}));case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,vt(a&&a.user?a.user.userPrincipalName:null).catch((function(e){console.log("getLicenseForUPN",e)}));case 7:o=e.sent,B(a.user.userPrincipalName),sessionStorage.getItem("HASLANDED")||(G(W.LANDING),sessionStorage.setItem("HASLANDED","1")),t({auth:a,license:o});case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()).then((function(e){e.interactionRequired?h(!0):(a(e.auth),l(e.license))})).catch((function(e){console.log("getUserAndLicense",e)}))}),[]),d.a.createElement(yt.a,xt.a,d.a.createElement(Ot.a,{theme:Nt},d.a.createElement(Dt,null,d.a.createElement(Jt,{interactionRequired:f}),d.a.createElement(Oe.a,null,d.a.createElement(Rt,{auth:n,path:"/"}),d.a.createElement(ct,{auth:n,path:"/home"}),d.a.createElement($e,{auth:n,path:"/board/:board",signOut:gt}),d.a.createElement(Mt,{path:"/getadminconsent"}),d.a.createElement(Wt,{path:"/adminconsented"}),d.a.createElement(Bt,{path:"/signedout"}),d.a.createElement(Gt,{path:"/signout"}),d.a.createElement(Ht,{path:"/debug"}),d.a.createElement(Ut,{default:!0})))))}function Yt(){return(Yt=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.a.render(d.a.createElement(Ft,null),document.getElementById("root"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.Office&&(window.Office.initialize=function(){console.log("Office running")}),function(){Yt.apply(this,arguments)}()},72:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return v}));var a,r=n(92),o=n(46),i=n(16),c=n(52),s=n(61),l=n(71),u=n(69),p=n(0),d=n.n(p),m=n(8),f=n.n(m),h=n(269),g=(n(330),n(270)),b={lg:1200,md:996,sm:768,xs:480,xxs:240},v=function(t){Object(l.a)(p,t);var n=Object(u.a)(p);function p(t){var s;return Object(c.a)(this,p),(s=n.call(this,t)).onBreakpointChange=function(e){s.setState((function(t){return{currentBreakpoint:e,toolbox:Object(i.a)(Object(i.a)({},t.toolbox),{},Object(o.a)({},e,t.toolbox[e]||t.toolbox[t.currentBreakpoint]||[]))}}))},s.onCompactTypeChange=function(){var e=s.state.compactType,t="horizontal"===e?"vertical":"vertical"===e?null:"horizontal";s.setState({compactType:t})},s.onTakeItem=function(e){s.setState((function(t){return{toolbox:Object(i.a)(Object(i.a)({},t.toolbox),{},Object(o.a)({},t.currentBreakpoint,t.toolbox[t.currentBreakpoint].filter((function(t){return t.i!==e.i})))),layouts:Object(i.a)(Object(i.a)({},t.layouts),{},Object(o.a)({},t.currentBreakpoint,[].concat(Object(r.a)(t.layouts[t.currentBreakpoint]),[e])))}}))},s.onPutItem=function(e){s.setState((function(t){return{toolbox:Object(i.a)(Object(i.a)({},t.toolbox),{},Object(o.a)({},t.currentBreakpoint,[].concat(Object(r.a)(t.toolbox[t.currentBreakpoint]||[]),[e]))),layouts:Object(i.a)(Object(i.a)({},t.layouts),{},Object(o.a)({},t.currentBreakpoint,t.layouts[t.currentBreakpoint].filter((function(t){return t.i!==e.i}))))}}))},s.onLayoutChange=function(t,n){var a,r;a="layouts",r=n,e.localStorage&&e.localStorage.setItem("rgl-8",JSON.stringify(Object(o.a)({},a,r))),s.props.persist&&s.props.persist(n),s.setState({layouts:n})},s.onNewLayout=function(){s.setState({layouts:{lg:x()}})},s.onResize=function(){s.props.tools&&s.props.tools.forEach((function(e){e.onResize&&e.onResize()}))},a=Object(g.a)(h.Responsive,t.fixedWidth),s.state={currentBreakpoint:"lg",compactType:"vertical",mounted:!1,toolbox:{lg:[]}},s}return Object(s.a)(p,[{key:"componentDidMount",value:function(){this.setState({mounted:!0})}},{key:"generateDOM",value:function(e,t){var n=this,a=this;return f.a.map(this.props.layouts[this.state.currentBreakpoint],(function(e){var t=a.props.tools&&a.props.tools[e.i]&&a.props.tools[e.i].tile?a.props.tools[e.i].tile:{title:e.i},r=Date.now();return d.a.createElement("div",{style:{backgroundColor:t.color,color:t.textcolor,cursor:n.props.editingLayout?"default":"pointer",overflow:"hidden"},key:e.i,"data-grid":{w:e.w,h:e.h,x:e.x,y:e.y},className:e.static?"static":""},d.a.createElement("span",null,a.props.getPin(e.i,e.w,e.h,r)))}))}},{key:"render",value:function(){return d.a.createElement("div",null,d.a.createElement(a,Object.assign({breakpoints:b,cols:{lg:12,md:10,sm:6,xs:4,xxs:2}},this.props,{margin:[0,0],containerPadding:[0,0],layouts:this.props.layouts,onBreakpointChange:this.onBreakpointChange,onLayoutChange:this.onLayoutChange,measureBeforeMount:!1,useCSSTransforms:!0,compactType:this.state.compactType,preventCollision:!this.state.compactType,onResize:this.onResize,isDraggable:this.props.editMode,isResizable:this.props.editMode}),this.generateDOM(this)))}}]),p}(d.a.Component);function x(){return f.a.map(f.a.range(0,25),(function(e,t){var n=Math.ceil(4*Math.random())+1;return{x:2*f.a.random(0,5)%12,y:Math.floor(t/6)*n,w:2,h:n,i:t.toString(),static:Math.random()<.05}}))}v.defaultProps={className:"layout",rowHeight:30,onLayoutChange:function(){},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},initialLayout:x()}}).call(this,n(23))}},[[296,1,2]]]);
//# sourceMappingURL=main.59b060cc.chunk.js.map